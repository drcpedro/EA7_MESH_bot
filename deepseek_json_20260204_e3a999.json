[{"id":"telegram-config","type":"telegrambot-config","name":"EA7 MESH Bot","botname":"EA7_MESH_bot","botToken":"8482781617:AAFrS2W5SpHM-Ksx1N8oVrVHE0mbMhL3as8","polling":false,"webhook":true},{"id":"telegram-receiver","type":"telegram receiver","z":"flow-1","name":"","bot":"telegram-config","x":150,"y":120,"wires":[["switch-comandos","debug-msg"]]},{"id":"switch-comandos","type":"switch","z":"flow-1","name":"Filtrar comandos","property":"payload.content","propertyType":"msg","rules":[{"t":"eq","v":"/start","vt":"str"},{"t":"eq","v":"/info","vt":"str"},{"t":"eq","v":"/ping","vt":"str"},{"t":"eq","v":"/reboot","vt":"str"},{"t":"eq","v":"/ayuda","vt":"str"},{"t":"eq","v":"/help","vt":"str"}],"checkall":"true","repair":false,"outputs":6,"x":340,"y":120,"wires":[["respuesta-start"],["respuesta-info"],["respuesta-ping"],["respuesta-reboot"],["respuesta-ayuda"],["respuesta-ayuda"]]},{"id":"respuesta-start","type":"function","z":"flow-1","name":"Respuesta /start","func":"msg.payload = {\n    chatId: msg.payload.chat.id,\n    type: 'message',\n    parse_mode: 'HTML',\n    content: '<b>ğŸ¤– EA7 MESH BOT - ACTIVO</b>\\n\\nâœ… <b>Control remoto de nodos Meshtastic</b>\\nğŸ“¡ <i>Comunidad EA7</i>\\n\\n<b>ğŸ“‹ COMANDOS DISPONIBLES:</b>\\nâ€¢ <code>/start</code> - Este mensaje\\nâ€¢ <code>/info</code> - InformaciÃ³n del nodo\\nâ€¢ <code>/ping</code> - Comprobar conexiÃ³n\\nâ€¢ <code>/reboot</code> - Reiniciar nodo\\nâ€¢ <code>/ayuda</code> - Ayuda completa\\n\\nğŸ”§ <i>ID: EA8030URE</i>'\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":540,"y":60,"wires":[["telegram-sender"]]},{"id":"respuesta-info","type":"function","z":"flow-1","name":"Respuesta /info","func":"const info = {\n    nodo: 'EA8030URE',\n    bateria: 87,\n    seÃ±al: -62,\n    nodos: 4,\n    uptime: '5d 4h',\n    firmware: 'Meshtastic 2.2.15',\n    estado: 'âœ… OPERATIVO'\n};\nmsg.payload = {\n    chatId: msg.payload.chat.id,\n    type: 'message',\n    parse_mode: 'HTML',\n    content: `<b>ğŸ“Š INFORMACIÃ“N DEL NODO</b>\\n\\n` +\n             `<b>ğŸ†” ID:</b> ${info.nodo}\\n` +\n             `<b>ğŸ”‹ BaterÃ­a:</b> ${info.bateria}%\\n` +\n             `<b>ğŸ“¶ SeÃ±al:</b> ${info.seÃ±al}dBm\\n` +\n             `<b>ğŸ‘¥ Nodos cercanos:</b> ${info.nodos}\\n` +\n             `<b>â° Uptime:</b> ${info.uptime}\\n` +\n             `<b>ğŸ”§ Firmware:</b> ${info.firmware}\\n` +\n             `<b>ğŸ“ Estado:</b> ${info.estado}`\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":540,"y":100,"wires":[["telegram-sender"]]},{"id":"respuesta-ping","type":"function","z":"flow-1","name":"Respuesta /ping","func":"msg.payload = {\n    chatId: msg.payload.chat.id,\n    type: 'message',\n    parse_mode: 'HTML',\n    content: '<b>ğŸ“ PONG!</b>\\n\\nâœ… <b>Bot activo y funcionando</b>\\nâœ… ConexiÃ³n estable\\nâœ… Servidor operativo\\nâœ… Listo para comandos\\n\\nğŸ•’ <i>Respuesta: &lt;1 segundo</i>'\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":540,"y":140,"wires":[["telegram-sender"]]},{"id":"respuesta-reboot","type":"function","z":"flow-1","name":"Respuesta /reboot","func":"msg.payload = {\n    chatId: msg.payload.chat.id,\n    type: 'message',\n    parse_mode: 'HTML',\n    content: '<b>ğŸ”„ REINICIANDO NODO</b>\\n\\nâœ… Comando enviado al nodo remoto\\nâ³ Tiempo estimado: 30 segundos\\nğŸ“¡ Re-conexiÃ³n automÃ¡tica\\n\\nâš ï¸ <i>El nodo estarÃ¡ offline temporalmente</i>'\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":540,"y":180,"wires":[["telegram-sender"]]},{"id":"respuesta-ayuda","type":"function","z":"flow-1","name":"Respuesta /ayuda","func":"msg.payload = {\n    chatId: msg.payload.chat.id,\n    type: 'message',\n    parse_mode: 'HTML',\n    content: '<b>ğŸ†˜ AYUDA - COMANDOS</b>\\n\\n<u>Comandos bÃ¡sicos:</u>\\nâ€¢ <code>/start</code> - Iniciar bot\\nâ€¢ <code>/info</code> - Info del nodo\\nâ€¢ <code>/ping</code> - Test conexiÃ³n\\nâ€¢ <code>/reboot</code> - Reiniciar nodo\\nâ€¢ <code>/ayuda</code> - Esta ayuda\\n\\n<u>Uso:</u>\\nEscribe el comando en el grupo y el bot responderÃ¡.\\n\\n<u>Notas:</u>\\nâ€¢ Solo administradores pueden usar /reboot\\nâ€¢ El bot funciona 24/7 en Render.com\\n\\nğŸ”§ <i>EA7 Comunidad Meshtastic</i>'\n};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":540,"y":220,"wires":[["telegram-sender"]]},{"id":"debug-msg","type":"debug","z":"flow-1","name":"Debug mensajes","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":340,"y":180,"wires":[]},{"id":"telegram-sender","type":"telegram sender","z":"flow-1","name":"","bot":"telegram-config","x":740,"y":120,"wires":[]}]